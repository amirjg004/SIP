function loadArchive(a,r){prevArcChanSelected=1,allTimersArray[chanSelected]||(allTimersArray[chanSelected]=[]);var c,t=new Date,o=new Date,n=Math.floor(t.getTime()/1e3);unbindArcClickEvents(),$("#fs_MenuContainer").remove(),$("#fs_MenuContainerBack").append('<div id="fs_MenuContainer"></div>'),$("#fs_chanMenu").show(),chanJSON=chData[a].chNr,arcUrlCheck=chData[a].chUrl,chanName=chData[a].chName,chLogoSmall=chData[a].logoSmall,chLogo=chData[a].logo,jsonArc=chData[a].chArc,isNaN(Number(jsonArc))||(maxArcDays=Number(jsonArc)),yy=o.getFullYear(),dd=o.getDate(),mm=o.getMonth()+1,dd<10&&(dd="0"+dd),mm<10&&(mm="0"+mm),newDateString=yy+"-"+mm+"-"+dd,arcJsonLink="",arcClass="";var s=0;for(utcTime=[],c=0;c<r.epg.length;c++){if(progStart=new Date(1e3*r.start[c]),progStartHours=progStart.getHours(),progStartHours+=DST,progStartMinutes=progStart.getMinutes(),progStartHours>=24?progStartHours-=24:progStartHours<0&&(progStartHours+=24),progStartHours<10&&(progStartHours="0"+progStartHours),progStartMinutes<10&&(progStartMinutes="0"+progStartMinutes),progStop=new Date(1e3*r.stop[c]),progStopHours=progStop.getHours(),progStopHours+=DST,progStopMinutes=progStop.getMinutes(),progStopHours>=24?progStopHours-=24:progStopHours<0&&(progStopHours+=24),progStopHours<10&&(progStopHours="0"+progStopHours),progStopMinutes<10&&(progStopMinutes="0"+progStopMinutes),progStart.toDateString()!==o.toDateString()&&0==dayNr){var l=progStart.toString().split(" ")[0];arcTime=l+" "+progStartHours+":"+progStartMinutes+" - "+progStopHours+":"+progStopMinutes}else arcTime=progStartHours+":"+progStartMinutes+" - "+progStopHours+":"+progStopMinutes;if(utcTime[c+1]=r.start[c],arcLink="arc_play.html?chan="+a+"&day=0&pg=1&utc="+utcTime,jsonArc)r.start[c]<=n?(arcClass='class="arc_eachMenuArcOn"',$("#fsPrevDay, #fsNextDay").show()):arcClass="";else e:for(e=0;e<epgArchive.length;e++)for(arcCheck=epgArchive[e].check,arcArray=epgArchive[e].channels,f=0;f<arcCheck.length;f++){if(-1!=arcUrlCheck.indexOf(arcCheck[f])&&-1!=arcArray.indexOf(chanJSON)&&r.start[c]<=n){arcClass='class="arc_eachMenuArcOn"',$("#fsPrevDay, #fsNextDay").show();break e}arcClass=""}if(n>r.start[c]&&n<r.stop[c]){chanClass="arc_eachMenuSelected";var i=c+1;timeActive='style="color: rgb(235,235,235);"',nameActive='style="color: rgb(235,235,235);"'}else chanClass="arc_eachMenuDefault",timeActive="",nameActive="";0!=dayNr&&(c+1==1?chanClass="arc_eachMenuSelected":(chanClass="arc_eachMenuDefault",timeActive="",nameActive="")),-1!=allTimersArray[chanSelected].indexOf(r.start[c])&&r.start[c]>parseInt(currentDate.getTime()/1e3)-3600*DST?timerClass='<span class="fs_eachTimerItem">&bull;</span>':timerClass="",$("#fs_MenuContainer").append("<div id=arc-"+(c+1)+' class="'+chanClass+'" style="top: '+38*s+'px;">\t\t\t\t\t<span id="'+(c+1)+'_arcObjName" class="arc_eachMenuTime"'+timeActive+">"+arcTime+timerClass+'</span>\t\t\t\t\t<span id="'+(c+1)+'_arcObjEPG" class="arc_eachMenuEPG"'+nameActive+'style="color:'+selectedEPGColor+';">'+r.epg[c]+'</span>\t\t\t\t\t<span id="'+(c+1)+'_arcObjArc"'+arcClass+"></span>\t\t\t\t</div>"),s++,arcTimeCharLength=$("#"+(c+1)+"_arcObjName").width(),arcEpgLength=maxArcEPGLength-arcTimeCharLength,$("#"+(c+1)+"_arcObjEPG").css("width",arcEpgLength)}$("#topLabelName").show(),$("#arcChanName").html(chanName+" EPG"),-1!=epgIconsSmallHi.indexOf(chanJSON)?$("#arcChanIcon").html('<img src="'+iconsPath+"icons_hi/small_hi/"+chanJSON+'.png" />'):-1!=epgIconsSmall.indexOf(chanJSON)?$("#arcChanIcon").html('<img src="'+iconsPath+"icons/small/"+chanJSON+'.png" />'):chLogoSmall?$("#arcChanIcon").html('<img src="'+chLogoSmall+'" onError="this.onerror=null;this.src='+imagesPath+"'icons/small/tvg_logo.png';\" />"):chLogo?$("#arcChanIcon").html('<img src="'+chLogo+'" onError="this.onerror=null;this.src='+imagesPath+"'icons/small/tvg_logo.png';\" />"):$("#arcChanIcon").html("");var h=$("#fs_MenuContainer").height()/$("#fs_MenuContainer")[0].scrollHeight;if(arcScrollHeight=$("#fs_MenuContainer")[0].scrollHeight,arcViewportHeight=$("#fs_MenuContainer").height(),arcScrollPosition=$("#fs_MenuContainer").scrollTop(),arcMenuProgressHeight=$("#fsMenuProgress").height(),arcProgRunnerHeight=$("#fsMenuProgress").height()*h,arcProgRunnerTop=$("#fs_MenuContainer").scrollTop(),$("#fsMenuProgress").show(),arcViewportHeight<arcScrollHeight&&($("#progRunner").show(),$("#progRunner").css("height",arcProgRunnerHeight+"px"),$("#progRunner").css("top",arcProgRunnerTop+"px"),$(document).bind("mousewheel",function(e,a){arcMouseScroll()})),arcClickEvents(),arcMouseChanSelector(),marqueeTimeout=setTimeout(arc_marqueeOn,600),i&&0==dayNr?arcChanSelected=i:arcChanSelected=1,totalScrollItems=s,i>pageItems)for(p=0;p<Math.floor(i/pageItems);p++)arcScrollDown()}function dayUp(){$("#fsPrevDay, #fsNextDay").is(":visible")&&(dayNr-=1,dayNr<-1*maxArcDays?dayNr=-1*maxArcDays:(setArcDate(),arcJSONPath=epgPath+"get_epg_archive.php",$.ajax({method:"GET",url:arcJSONPath,data:{channel:chanJSON,day:arcJump,epgId:epgId},dataType:"json"}).done(function(e){e&&(progEPG=e,loadArchive(chanSelected,e))})))}function dayDown(){$("#fsPrevDay, #fsNextDay").is(":visible")&&(dayNr+=1,dayNr>0?dayNr=0:(setArcDate(),0==dayNr?(arcJSONPath=epgPath+"get_epg_schedule.php",$("#arcDate").hide()):arcJSONPath=epgPath+"get_epg_archive.php",$.ajax({method:"GET",url:arcJSONPath,data:{channel:chanJSON,day:arcJump,epgId:epgId},dataType:"json"}).done(function(e){e&&(progEPG=e,loadArchive(chanSelected,e))})))}function arcChanSelector(e){marqueeOff(),$("[class*=arc_eachMenuSelected]").toggleClass("arc_eachMenuSelected arc_eachMenuDefault"),$("[class*=fs_eachTimerClock]").remove(),arcChanSelected+=e,arcChanSelected<=0?arcChanSelected=1:arcChanSelected>totalScrollItems&&(arcChanSelected=totalScrollItems);var a=$("#arc-"+arcChanSelected).position().top;a>=38*pageItems?arcScrollDown():a<0&&arcScrollUp(),$("#arc-"+arcChanSelected).toggleClass("arc_eachMenuDefault arc_eachMenuSelected"),marqueeTimeout=setTimeout(arc_marqueeOn,600),!$("#"+arcChanSelected+"_arcObjEPG .fs_eachTimerClock").length&&progEPG.start[arcChanSelected-1]>parseInt(currentDate.getTime()/1e3)-3600*DST&&$("#"+arcChanSelected+"_arcObjEPG").append('<span class="fs_eachTimerClock"><img src="images/new/icon_clock.svg"></span>'),$("#"+arcChanSelected+"_arcObjName .fs_eachTimerItem").length?$("#fsTimerButton span").html("Remove Timer"):$("#fsTimerButton span").html("Set Timer"),prevArcChanSelected=arcChanSelected}function arcChannelLaunch(){$("#arc-"+arcChanSelected).children(".arc_eachMenuArcOn").attr("id")&&(arcID=Number($("#arc-"+arcChanSelected).attr("id").replace("arc-","")),localStorage_setItem("arcChannel",chanSelected),localStorage_setItem("arcOffset",utcTime[arcID]),chDataLoaded&&(localStorage_setItem("arcEntry","fullscreen"),arcFromMenu&&restoreLocation()),window.location="arc_play.html"),progEPG.start[arcChanSelected-1]>parseInt(currentDate.getTime()/1e3)-3600*DST&&setTimer()}function arcClickEvents(){$(".arc_eachMenuDefault, .arc_eachMenuSelected").click(function(){var e=$(this).children(".arc_eachMenuArcOn").attr("id");$(event.target).attr("class"),e&&(arcID=Number(e.replace("_arcObjArc","")),localStorage_setItem("arcChannel",chanSelected),localStorage_setItem("arcOffset",utcTime[arcID]),localStorage_setItem("arcEntry","fullscreen"),window.location="arc_play.html"),setTimer("mouse")})}function unbindArcClickEvents(){$("[class$='eachMenuDefault']").off()}function arcKeyScroll(){$(document).keydown(function(e){switch(e.which){case 39:arcChanSelector(15);break;case 37:arcChanSelector(-15);break;case 40:arcChanSelector(1);break;case 38:arcChanSelector(-1);break;case 13:arcChannelLaunch()}})}function arcMouseChanSelector(){$(".arc_eachMenuDefault, .arc_eachMenuSelected").hover(function(){$("[class*=arc_eachMenuSelected]").toggleClass("arc_eachMenuSelected arc_eachMenuDefault"),$(this).attr("class","arc_eachMenuSelected"),hoverID=this.id,hoverID=Number(hoverID.replace("arc-","")),arcChanSelected=hoverID,marqueeTimeout=setTimeout(function(){arc_marqueeCalc(hoverID)},600),!$("#"+arcChanSelected+"_arcObjEPG .fs_eachTimerClock").length&&progEPG.start[arcChanSelected-1]>parseInt(currentDate.getTime()/1e3)-3600*DST&&$("#"+arcChanSelected+"_arcObjEPG").append('<span class="fs_eachTimerClock"><img src="images/new/icon_clock.svg"></span>'),$("#"+arcChanSelected+"_arcObjName .fs_eachTimerItem").length?$("#fsTimerButton span").html("Remove Timer"):$("#fsTimerButton span").html("Set Timer")},function(){$(this).attr("class","arc_eachMenuDefault"),$("[id*='_arcObjEPG']").removeClass("marquee"),marqueeOff(),$("[class*=fs_eachTimerClock]").remove()})}function arc_marqueeCalc(e){var a=$("#"+e+"_arcObjEPG").textWidth(),r=$("#"+e+"_arcObjEPG").width();a>r&&($("#"+e+"_arcObjEPG").addClass("marquee"),marqueeEPG(r))}function arc_marqueeOn(){var e=arcChanSelected,a=$("#"+e+"_arcObjEPG").textWidth(),r=$("#"+e+"_arcObjEPG").width();a>r&&($("#"+e+"_arcObjEPG").addClass("marquee"),marqueeEPG(r))}function arcMouseScroll(){window.event.wheelDelta>0?arcScrollUp():arcScrollDown()}function arcScrollUp(){arcScrollPosition-=arcViewportHeight,arcScrollPosition<0&&(arcScrollPosition=0),$("#fs_MenuContainer").scrollTop(arcScrollPosition),arcProgRunnerTop=Math.round(arcMenuProgressHeight*$("#fs_MenuContainer").scrollTop()/arcScrollHeight),$("#progRunner").css("top",arcProgRunnerTop+"px")}function arcScrollDown(){arcScrollPosition+=arcViewportHeight,arcScrollPosition+arcViewportHeight>arcScrollHeight&&(arcScrollPosition=arcScrollHeight-arcViewportHeight),$("#fs_MenuContainer").scrollTop(arcScrollPosition),arcProgRunnerTop=Math.round(arcMenuProgressHeight*$("#fs_MenuContainer").scrollTop()/arcScrollHeight),$("#progRunner").css("top",arcProgRunnerTop+"px")}function arcScrollReset(){$("#progRunner").hide(),$("#fs_MenuContainer").scrollTop(0),$("#progRunner").css("height","0px"),$("#progRunner").css("top","0px")}