function loadMenu(e,a){var t;setYellowButtonText(),$("#loadingSpinner").show(),epgInfo=epgData,unbindChanClickEvents(),$("#menuContainer").remove(),$("#innerContainer").append('<div id="menuContainer"></div>'),menuChannelCount=channelCount,"All"!=activeGroup?(e==pageCount?tailItems=activeGroupLength-(e-1)*pageItems:tailItems=pageItems,countStart=activeGroupStart+(e-1)*pageItems,countStop=countStart+tailItems):(favList?(menuChannelCount-=favList.length,pageCount=Math.ceil(menuChannelCount/pageItems)):pageCount=Math.ceil(channelCount/pageItems),e==pageCount?tailItems=menuChannelCount-(e-1)*pageItems:tailItems=pageItems,countStart=(e-1)*pageItems,countStop=countStart+tailItems);var n,r,c=0,o=[];for(chanGroup="",l=0;l<columnCount;l++)o[l]=0;for(t=countStart;t<countStop;t++)if("All"!=activeGroup||!chData[t+1].favPos){allTimersArray[t+1]||(allTimersArray[t+1]=[]),(c+=1)<=rowCount?(xPosition=1,o[0]=o[0]+1,yPosition=o[0]):c>rowCount&&c<=2*rowCount?(xPosition=2,o[1]=o[1]+1,yPosition=o[1]):c>2*rowCount&&c<=3*rowCount?(xPosition=3,o[2]=o[2]+1,yPosition=o[2]):(xPosition=4,o[3]=o[3]+1,yPosition=o[3]);var i=(eachMenuHeight+6)*(yPosition-1),h=(eachMenuWidth+6)*(xPosition-1);if(groupIconValue="",watchedIconValue="",arcClass="",jsonChNr=chData[t+1].chNr,jsonChUrl=chData[t+1].chUrl,arcUrlCheck=chData[t+1].chUrl,jsonLogo=chData[t+1].logo,jsonArc=chData[t+1].chArc,jsonDvbNr=chData[t+1].dvbNr?chData[t+1].dvbNr:"",chanNumber=t+1,"All"==activeGroup&&1!=chData[t+1].pos&&0!=chData[0])for(var s=0;s<chData[0].length;s++){if(chData[t+1].pos==chData[0][s].pos+1){groupIconValue='<span class="eachGroupItem"></span>';break}groupIconValue=""}if(epgInfo.epg1[jsonChNr]?(chanEPG=epgInfo.epg1[jsonChNr],menuChLeft=Math.ceil((epgInfo.start2[jsonChNr]+3600*DST-currentDate.getTime()/1e3)/60),menuChLength=(epgInfo.start2[jsonChNr]-epgInfo.start1[jsonChNr])/60,progSize='style="display: block;"',barSize='style="width:'+(menuChLength-menuChLeft)/menuChLength*100+'%; max-width: 100%;"'):"avi"==chData[t+1].chNr?(chanNumber="",chanEPG=chData[t+1].chUrl,chanEPGArray=chanEPG.split("/"),chanEPG=chanEPGArray[chanEPGArray.length-1],chanEPG=chanEPG.replace("watch?v=",""),progSize='style="display: block;',barSize=""):-1!=jsonChUrl.indexOf("tv://")?(chanEPG=jsonDvbNr.toUpperCase(),progSize='style="display: none;',barSize=""):"noepg"==chData[t+1].chNr?(chanEPG="No EPG code set, please check codes.siptv.app",progSize='style="display: none;',barSize=""):(chanEPG="",progSize='style="display: none;',barSize=""),null!=chData[t+1].chName?chanName=chData[t+1].chName:chanName="",-1!=jsonChUrl.indexOf("youtube.com")||-1!=jsonChUrl.indexOf("youtu.be")?chanPicon='<img src="'+imagesPath+'icons/youtube.png">':-1!=jsonChUrl.indexOf("vk.com")||-1!=jsonChUrl.indexOf("vkontakte.com")?chanPicon='<img src="'+imagesPath+'icons/vk.png">':"avi"==chData[t+1].chNr?chanPicon='<img src="'+imagesPath+'icons/avi.png">':-1!=epgIconsHi.indexOf(jsonChNr)&&"dvb"!=jsonChNr&&"ext"!=jsonChNr?chanPicon='<img src="'+iconsPath+"icons_hi/"+jsonChNr+'.png">':-1!=epgIcons.indexOf(jsonChNr)&&"dvb"!=jsonChNr&&"ext"!=jsonChNr?chanPicon='<img src="'+iconsPath+"icons/"+jsonChNr+'.png">':jsonLogo&&"dvb"!=jsonChNr?chanPicon='<img src="'+jsonLogo+'" onError="this.onerror=null;this.src='+imagesPath+"'icons/small/tvg_logo.png';\" />":"dvb-"==jsonDvbNr.substr(0,4)||"dvbt-"==jsonDvbNr.substr(0,5)||"dvba-"==jsonDvbNr.substr(0,5)?(chanPicon='<img src="'+imagesPath+'icons/small/dvb.png">',progSize='style="display: block;',barSize=""):"dvbc-"==jsonDvbNr.substr(0,5)?(chanPicon='<img src="'+imagesPath+'icons/small/dvbc.png">',progSize='style="display: block;',barSize=""):"dvbs-"==jsonDvbNr.substr(0,5)?(chanPicon='<img src="'+imagesPath+'icons/small/dvbs.png">',progSize='style="display: block;',barSize=""):chanPicon="",jsonArc)arcClass='class="eachMenuArc"';else e:for(n=0;n<epgArchive.length;n++)for(arcCheck=epgArchive[n].check,arcArray=epgArchive[n].channels,r=0;r<arcCheck.length;r++){if(-1!=arcUrlCheck.indexOf(arcCheck[r])&&-1!=arcArray.indexOf(jsonChNr)){arcClass='class="eachMenuArc"',chData[t+1].chArc=15;break e}arcClass=""}if(chanClass=t+1==a?"eachMenuSelected":"eachMenuDefault","Favourites"==activeGroup?chanPos=chData[t+1].favPos:chanPos=t+1,"avi"==chData[t+1].chNr)if(chanPos="",noNumber=" noNumber",localStorage_getItem(chData[t+1].chUrl)){watchedIconValue='<span class="eachWatchedItem"></span>',progSize='style="display: block; width: 260px;"';try{videoData=JSON.parse(localStorage_getItem(chData[t+1].chUrl))}catch(n){console.log(n),localStorage_removeItem(chData[t+1].chUrl)}"object"==typeof videoData&&(videoPlayed=videoData.saved,videoLength=videoData.total,progSize='style="display: block; width: 260px;"',barSize='style="width:'+videoPlayed/videoLength*100+'%; max-width: 100%;"',chanEPG="["+timeConvert(videoData.total)+"] - "+chanEPG,videoData.title&&0!=videoData.title&&(chanName=decodeURIComponent(videoData.title)))}else watchedIconValue="";else noNumber="";if(-1!=favList.indexOf(sortSet?chData[t+1].origPos:chData[t+1].pos)&&"Favourites"!=activeGroup)favIconValue='<span class="eachFavItem"></span>';else if(favList.length>0&&"Favourites"!=activeGroup)for(var u=0;u<favList.length;u++){if(favList[u].chUrl==chData[t+1].chUrl&&favList[u].chNr==chData[t+1].chNr){favIconValue='<span class="eachFavItem"></span>';break}favIconValue=""}else favIconValue="";allTimersArray[t+1].length>0?timerIconValue='<span class="eachTimerItem"></span>':timerIconValue="",$("#menuContainer").append("<div id="+(t+1)+' class="'+chanClass+'" style="width: '+eachMenuWidth+"px; height: "+eachMenuHeight+"px; top: "+i+"px; left: "+h+'px;">\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjBase">'+favIconValue+timerIconValue+groupIconValue+watchedIconValue+'</span>\t\t\t\t\t\t<span class="eachMenuNoName">\t\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjNo" class="eachMenuNo">'+chanPos+'</span>\t\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjName" class="eachMenuName'+noNumber+'">'+chanName+'</span>\t\t\t\t\t\t</span>\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjPicon" class="eachMenuPicon">'+chanPicon+'</span>\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjArc" '+arcClass+'></span>\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjEPG" class="eachMenuEPG" style="color:'+selectedEPGColor+';">'+chanEPG+'</span>\t\t\t\t\t\t<span id="'+(t+1)+'_innerObjProgress" class="eachMenuProgress" '+progSize+'>\t\t\t\t\t\t\t<span class="progSpan" '+barSize+"></span>\t\t\t\t\t\t</span>\t\t\t\t\t</div>"),totalCharLength=$("#"+(t+1)+"_innerObjNo").width()+$("#"+(t+1)+"_innerObjPicon").width(),epgLength=maxEPGLength-totalCharLength-14,$("#"+(t+1)+"_innerObjName").css("width",epgLength)}$("#loadingSpinner").hide(),pageProgress(),menuClickEvents(),marqueeTimeout=setTimeout("marqueeOn(); marqueeTitleOn();",600),mouseOn=!1}function menuClickEvents(){$(".eachMenuDefault, .eachMenuSelected").click(function(){var e=$(event.target).attr("class");if("epgHover"==e||"eachMenuArc"==e)a=Number($(this).attr("id")),chanSelected=a,getToArchive();else if(chData[chanSelected].par&&"on"!=sessionStorage.getItem("parentCode"))parentalCheck();else{var a=Number($(this).attr("id"));localStorage_setItem(menuChannelCookie,a),"avi"==chData[a].chNr?(localStorage_setItem("realChanNr",a),localStorage_setItem("playerEntry","channels"),window.location="player.html?chan="+a):window.location="fullscreen.html?chan="+a}}),$("#menuNavigation").click(function(e){if(!parentExecuted&&!howtoOn){var a=Number($(e.target).parent().attr("id").replace("menuPgNr-",""));if(a>pgNr)chanSelected+=(a-pgNr)*pageItems;else{if(!(a<pgNr))return!1;chanSelected-=(pgNr-a)*pageItems}pgNr=a,loadMenu(pgNr,chanSelected)}}),$("#page_right").click(function(){chanPageUp()}),$("#page_left").click(function(){chanPageDown()})}function unbindChanClickEvents(){$("#menuNavigation").off(),$(".eachMenuDefault, .eachMenuSelected").off(),$(".eachMenuArc").off(),$("#page_left").off(),$("#page_right").off()}function marqueeOn(){var e=chanSelected,a=$("#"+e+"_innerObjEPG").textWidth(),t=$("#"+e+"_innerObjEPG").width();a>t&&($("#"+e+"_innerObjEPG").addClass("marquee"),marqueeEPG(t))}function marqueeTitleOn(){var e=chanSelected,a=$("#"+e+"_innerObjName").textWidth(),t=$("#"+e+"_innerObjName").width();a>t&&($("#"+e+"_innerObjName").addClass("marquee_title"),marqueeTitle(t))}function marqueeOff(){$(".js-marquee").unwrap(),$(".js-marquee:first").remove(),$(".js-marquee").contents().unwrap(),clearTimeout(marqueeTimeout)}function marqueeEPG(e){$(".marquee").marquee({allowCss3Support:!1,duplicated:!0,duration:4e3,gap:e/3,delayBeforeStart:0,direction:"left"})}function marqueeTitle(e){$(".marquee_title").marquee({allowCss3Support:!1,duplicated:!0,duration:4e3,gap:e/3,delayBeforeStart:0,direction:"left"})}function chanSelector(e){$("#"+chanSelected+"_innerObjName").removeClass("marquee_title"),$("#"+chanSelected+"_innerObjEPG").removeClass("marquee"),marqueeOff(),mouseOn&&($("#"+hoverID).attr("class","eachMenuDefault"),$("#"+hoverID+"_innerObjEPG").attr("class","eachMenuEPG")),$("#"+chanSelected).attr("class","eachMenuDefault"),$("#"+chanSelected+"_innerObjEPG").attr("class","eachMenuEPG"),mouseOn=!1,chanSelected+=e,chanSelected==activeGroupStart&&-1==e?(chanSelected=menuChannelCount,pgNr=pageCount,loadMenu(pgNr,chanSelected)):chanSelected>menuChannelCount&&1==e?(chanSelected=activeGroupStart+1,pgNr=1,loadMenu(pgNr,chanSelected)):chanSelected>menuChannelCount&&pgNr==pageCount?!groupOn||groupScroll?(chanPosition=chanSelected-(pageCount*pageItems-pageItems)-e,chanColumn=Math.ceil((chanPosition-activeGroupStart)/rowCount),chanSelected=chanPosition-(chanColumn-1)*rowCount,5==e&&(pgNr=1),chanSelected>menuChannelCount-pageItems*pgNr&&(chanSelected=menuChannelCount),loadMenu(pgNr,chanSelected)):pgNr>=pageCount&&5==e?(groupNr++,switchGroup()):(chanSelected>menuChannelCount-pageItems*pgNr&&(chanSelected=menuChannelCount),loadMenu(pgNr,chanSelected)):chanSelected>menuChannelCount&&pgNr<pageCount?(chanSelected=menuChannelCount,pageSelector(1)):chanSelected>menuChannelCount&&pgNr>pageCount?(chanPosition=chanSelected-(pageCount*pageItems-pageItems)-e,chanColumn=Math.ceil((chanPosition-activeGroupStart)/rowCount),chanSelected=chanPosition-(chanColumn-1)*rowCount,pgNr=1,loadMenu(pgNr,chanSelected)):chanSelected<activeGroupStart+1?!groupOn||groupScroll?(chanPosition=chanSelected-activeGroupStart-e,lastColumn=Math.ceil((menuChannelCount-(pageCount*pageItems-pageItems)-activeGroupStart)/rowCount),misJump=pageCount*pageItems-pageItems+5*(lastColumn-1)+chanPosition+activeGroupStart,misJump>menuChannelCount?chanSelected=menuChannelCount:misJump<menuChannelCount?chanSelected=misJump:chanSelected=menuChannelCount,pgNr=pageCount,loadMenu(pgNr,chanSelected)):(groupNr--,switchGroup()):chanSelected-activeGroupStart-pgNr*pageItems>0?!groupOn||groupScroll?pageSelector(1):(groupNr++,switchGroup()):chanSelected-activeGroupStart-(pgNr-1)*pageItems<=0?!groupOn||groupScroll?pageSelector(-1):(groupNr++,switchGroup()):($("#"+chanSelected).attr("class","eachMenuSelected"),marqueeTimeout=setTimeout("marqueeOn(); marqueeTitleOn();",600))}function pageSelector(e){marqueeOff(),pgNr+=e,0==pgNr&&(pgNr=1),pgNr>=1&&-1==e&&loadMenu(pgNr,chanSelected),pgNr<=pageCount&&1==e&&loadMenu(pgNr,chanSelected)}function chanPageUp(){1!=pageCount&&(pageSelector(1),chanSelector(pageItems))}function chanPageDown(){1!=pageCount&&(pageSelector(-1),chanSelector(-1*pageItems))}function channelLaunch(){groupJumpCheck(),chData[chanSelected].par&&"on"!=sessionStorage.getItem("parentCode")?parentalCheck():(localStorage_setItem(menuChannelCookie,chanSelected),"avi"==chData[chanSelected].chNr?(localStorage_setItem("realChanNr",chanSelected),localStorage_setItem("playerEntry","channels"),window.location="player.html?chan="+chData[chanSelected].pos):window.location="fullscreen.html?chan="+chData[chanSelected].pos)}function mouseChanSelector(){$(".eachMenuDefault, .eachMenuSelected").hover(function(){clearTimeout(marqueeTimeout),$(this).attr("class","eachMenuSelected"),hoverID=Number(this.id),chanSelected=hoverID,grExecuted&&(groupSelected=hoverID),(epgData.epg1[chData[hoverID].chNr]||$("#"+hoverID+" .eachMenuArc").length)&&"EPG Data Offline"!=epgData.epg1[codeData[0]]&&$("#"+hoverID+"_innerObjBase").append('<span class="epgHover"></span>'),mousePrevSelected=$("#"+hoverID).attr("id"),marqueeTimeout=setTimeout(function(){marqueeTitleCalc(hoverID),marqueeCalc(hoverID)},600)},function(){$("[class*=eachMenuSelected]").toggleClass("eachMenuSelected eachMenuDefault"),$("#"+mousePrevSelected+"_innerObjName").removeClass("marquee_title"),$("#"+mousePrevSelected+"_innerObjEPG").removeClass("marquee"),$("[class*=epgHover]").remove(),marqueeOff()})}function marqueeCalc(e){var a=$("#"+e+"_innerObjEPG").textWidth(),t=$("#"+e+"_innerObjEPG").width();a>t&&($("#"+e+"_innerObjEPG").addClass("marquee"),marqueeEPG(t))}function marqueeTitleCalc(e){var a=$("#"+e+"_innerObjName").textWidth(),t=$("#"+e+"_innerObjName").width();a>t&&($("#"+e+"_innerObjName").addClass("marquee_title"),marqueeTitle(t))}columnCount=4,rowCount=5,eachMenuWidth=296,eachMenuHeight=110;var parentNumberKeyInput="";function parentalCheck(){parentHide(),parentExecuted=!0,chData[chanSelected].par&&"on"!=sessionStorage.getItem("parentCode")&&parAttempts<maxParAttempts?($("#parentPopUpOuter").show(),mouseOn&&$("#parentKeyboard").show(),$("#parentPopUp").css("top",($("#parentPopUpOuter").outerHeight()-$("#parentPopUp").outerHeight())/2),parentKeyEvents()):(parentExecuted=!1,showToast("Channel locked!"))}function parentKeyPress(e){clearTimeout(numberKeyTimer),1==parentNumberKeyInput.length?parentNumberKeyField(parentNumberKeyInput+=e):2==parentNumberKeyInput.length?parentNumberKeyField(parentNumberKeyInput+=e):3==parentNumberKeyInput.length?(parentNumberKeyField(parentNumberKeyInput+=e),numberKeyTimer=setTimeout(parentKeySubmit,500)):parentNumberKeyField(parentNumberKeyInput=""+e)}function parentNumberKeyField(e){for($("#parentPIN").html(e),i=0;i<4-e.length;i++)$("#parentPIN").append("�")}function parentKeySubmit(){clearTimeout(numberKeyTimer),parAttempts+=1,"����"==$("#parentPIN").html()||parAttempts==maxParAttempts?parentHide():parentNumberKeyInput==chData[chanSelected].par?(sessionStorage.setItem("parentCode","on"),parentNumberKeyInput="",parentHide(),channelLaunch()):($("#parentPIN").html("����"),parentNumberKeyInput="")}function parentHide(){$("#parentKeyboard").hide(),$("#parentPopUpOuter").hide(),rebindKeys(),$(".parentNumKey").unbind(),$(".parentCtrlKey").unbind(),parentNumberKeyInput="",keyNrOn=!1,numKeyActive=!1,mouseOn=!1,parentExecuted=!1,lastNumKeyStep=3,$("#parentPIN").html("����"),$(".parentNumKey").removeClass("selected")}function timeConvert(e){e=Number(e);var a=Math.floor(e/3600),t=Math.floor(e%3600/60),n=Math.floor(e%3600%60);return(a>0?a+":":"")+(t>0?(a>0&&t<10?"0":"")+t+":":"0:")+(n<10?"0":"")+n}