if("lg"==localStorage_getItem("colorTheme")?$("#ui_colors").attr("href","css/colors/lg.css"):"android"==localStorage_getItem("colorTheme")?$("#ui_colors").attr("href","css/colors/android.css"):"yellow"==localStorage_getItem("colorTheme")?$("#ui_colors").attr("href","css/colors/yellow.css"):"green"==localStorage_getItem("colorTheme")?$("#ui_colors").attr("href","css/colors/green.css"):"violet"==localStorage_getItem("colorTheme")?$("#ui_colors").attr("href","css/colors/violet.css"):$("#ui_colors").attr("href","css/colors/lg.css"),sessionStorage.getItem("ajaxTimeout")&&$.ajaxSetup({timeout:ajaxTimeout}),localStorage_getItem("myUzer"))var myUzer=localStorage_getItem("myUzer");else myUzer="default-lg";if(localStorage_getItem("secret")?secret=localStorage_getItem("secret"):secret="","on"==localStorage_getItem("DST")?DST=1:DST=0,localStorage_getItem("timeTune")){var timeTune=localStorage_getItem("timeTune");DST=Number(DST)+Number(timeTune)}var chanSelected=Number(localStorage_getItem("realChanNr")),entryPoint=localStorage_getItem("playerEntry");backPath="fullscreen"==entryPoint?"fullscreen.html":"channels.html";var privateList=localStorage_getItem("privateList");localStorage_getItem("vkToken")?VKAccessToken=localStorage_getItem("vkToken"):VKAccessToken="80144bfb58657fc2864e5a84371d62d791a80df5226aef91dbdfbcdcb1919b821abb0bad31dbcef07b16a",Number(localStorage_getItem("continuousPlay"))?continuousPlay=Number(localStorage_getItem("continuousPlay")):continuousPlay=1;var ibarTimeOut,scriptsPath="https://scr.siptv.app/common/scripts/",imagesPath="",allScriptsPath="https://all.siptv.app/",loadingSpinner='<div class="loadingSpinner">Loading...</div>',errBadVideoFormat='<div class="errorMessage"><p>Video error!</p></div>',urlFailMessage="",clockOn=!1,videoSub=!1,audioInfoReady=!1;function loadChInfo(){$.ajax({method:"GET",dataType:"json",url:scriptsPath+"get_list_local.php",data:{cid:myUzer,keep:privateList,secret:secret}}).done(function(e){privateList&&localStorage_getItem("chData")?(console.log("Local!"),e=JSON.parse(localStorage_getItem("chData"))):console.log("Server!"),privateList&&localStorage_removeItem("chListUpdate"),processVideo(e)}).fail(function(e,a){console.log("Fail!"),chData=JSON.parse(localStorage_getItem("chData")),processVideo(chData)})}function processVideo(e){chData=e,addDVBChListStored()}function channelFinalize(){getFavourites(),preloadFavourites(),getActiveGroup(),sortChannels(),chDataSelected=chData[chanSelected],chNr=chDataSelected.chNr,chName=chDataSelected.chName,chPos=chDataSelected.pos,chUrl=chDataSelected.chUrl,videoFound=!1;for(var e=0;e<localStorage.length;e++)if(-1!=localStorage.key(e).indexOf("://")){for(var a=1;a<chData.length;a++)if("avi"==chData[a].chNr){if(localStorage.key(e)==chData[a].chUrl){videoFound=!0;break}videoFound=!1}videoFound||localStorage_removeItem(localStorage.key(e))}if(mediaURL=chDataSelected.chUrl,videoName=chDataSelected.chName,videoSub=chDataSelected.chUdp,urlUDP=chDataSelected.chUdp,vData={},vData.title=0,-1==mediaURL.indexOf("vk.com")&&-1==mediaURL.indexOf("vkontakte.com")||(jQuery.ajaxSetup({async:!1}),getVkontakteLink()),-1==mediaURL.indexOf("youtube")&&-1==mediaURL.indexOf("youtu.be")||(jQuery.ajaxSetup({async:!1}),getYoutubeLink()),!mediaURL)return mediaURL="http://video-failed.com",urlFailMessage="Video failed!..",void window.location.replace(backPath);"yt-fail"!=mediaURL&&"vk-fail"!=mediaURL?showVideo():onVideoError()}function showVideo(){webOSNative=!0;var e={mediaTransportType:"URI"};subsOn=!0,e.htmlMediaOption={},e.htmlMediaOption.useUMSMediaInfo=!0,e.option={},e.option.subtitle={},e.option.subtitle.show=subsOn;var a=escape(JSON.stringify(e)),t=document.createElement("source");t.setAttribute("src",mediaURL),videoType="video/mp4",t.setAttribute("type",videoType+";mediaOption="+a),video.appendChild(t),video.load(),playerBindEvents(),$("#videoName").html(videoName),-1===mediaURL.indexOf(".mp3")&&-1===mediaURL.indexOf(".wav")&&-1===mediaURL.indexOf(".aac")||($("#musicNote").attr("src","images/musicNote2.svg"),$("#videoName").append(" / Audio")),errorRetryCount=0,prevTime=0}function chanZapper(){window.location.reload(!0)}function restoreMenu(e){2!=continuousPlay&&3!=continuousPlay||"playback"==e?window.location.replace(backPath):playNextVideo()}function loadContinuousPlay(){1==continuousPlay&&$("#playMode").html('<img src="images/play_mode_1.svg" alt=""/>'),2==continuousPlay&&$("#playMode").html('<img src="images/play_mode_2.svg" alt=""/>'),3==continuousPlay&&$("#playMode").html('<img src="images/play_mode_3.svg" alt=""/>')}function setContinuousPlay(){continuousPlay+=1,continuousPlay>3&&(continuousPlay=1),loadContinuousPlay(),localStorage_setItem("continuousPlay",continuousPlay)}function playNextVideo(){var e=chanSelected,a=chanSelected+1;if(a>chData.length-1){if(3!=continuousPlay)return void window.location.replace(backPath);a=1}if("avi"==chData[a].chNr&&chData[a].gr==chData[e].gr)runSelectedVideo(a);else{if(3!=continuousPlay)return void window.location.replace(backPath);for(var t=0;t<chData.length;t++)if("avi"==chData[t].chNr&&chData[t].gr==chData[chanSelected].gr){runSelectedVideo(t);break}}}function playPreviousVideo(){var e=chanSelected,a=chanSelected-1;if(a<=0){if(3!=continuousPlay)return void window.location.replace(backPath);a=chData.length-1}if("avi"==chData[a].chNr&&chData[a].gr==chData[e].gr)runSelectedVideo(a);else{if(3!=continuousPlay)return void window.location.replace(backPath);for(var t=chData.length-1;t>0;t--)if("avi"==chData[t].chNr&&chData[t].gr==chData[chanSelected].gr){runSelectedVideo(t);break}}}function runSelectedVideo(e){localStorage_setItem("realChanNr",e),"fullscreen"!=entryPoint&&localStorage_setItem("currentChannel",e),window.location.reload(!0)}function getYoutubeLink(){-1!=mediaURL.indexOf("http://youtu.be/")?yt_id=mediaURL.replace("http://youtu.be/",""):-1!=mediaURL.indexOf("https://youtu.be/")?yt_id=mediaURL.replace("https://youtu.be/",""):yt_id=mediaURL.split("?v=")[1],inputUrl="https://www.youtube.com/get_video_info?video_id="+yt_id,xhr=$.ajax({url:inputUrl,dataType:"text"}).done(function(e){uriComponents=e.split("&"),uriArray={},$.each(uriComponents,function(e,a){valuesArray=a.split("="),uriArray[valuesArray[0]]=valuesArray[1].replace(/\+/g,"%20")}),"fail"==uriArray.status?(mediaURL="yt-fail",ytFailMessage=decodeURIComponent(uriArray.reason),ytFailMessage=ytFailMessage.split("<br")[0],urlFailMessage=ytFailMessage):(streamMap=decodeURIComponent(uriArray.url_encoded_fmt_stream_map),streamMap=streamMap.split(","),streamMapArray={},$.each(streamMap,function(e,a){valuesArray=a.split("&"),streamMapArray[e]={},$.each(valuesArray,function(a,t){t=t.split("="),streamMapArray[e][t[0]]=t[1]})}),newStreamMapArray=[],index4=0,$.each(streamMapArray,function(e,a){-1!=a.type.indexOf("mp4")&&(newStreamMapArray[index4]={},newStreamMapArray[index4]=a,index4++)}),videoName='<span id="videoType"><img src="'+imagesPath+'icons/youtube.png"></span>'+videoName,mediaURL=decodeURIComponent(newStreamMapArray[0].url))})}function getVkontakteLink(){inputUrl=mediaURL,video_id=inputUrl.split("vk.com/video")[1],access_token=VKAccessToken,video_url="https://api.vk.com/method/video.get?videos="+video_id+"&access_token="+access_token+"&v="+vkApiVersion,xhr=$.ajax({url:video_url,dataType:"text"}).done(function(e){videoInfo=$.parseJSON(e),0==videoInfo.response.items.length?(mediaURL="vk-fail",urlFailMessage="Video failed!.."):(videoInfo=videoInfo.response.items[0],ownerId=videoInfo.owner_id,ownerId<0?getMethod="groups.getById?group_id=":getMethod="users.get?user_ids=",user_url="https://api.vk.com/method/"+getMethod+Math.abs(ownerId)+"&access_token="+access_token+"&v="+vkApiVersion,xhr=$.ajax({url:user_url,dataType:"text"}).done(function(e){ownerInfo=$.parseJSON(e),ownerId<0?videoAuthor=ownerInfo.response[0].name:videoAuthor=ownerInfo.response[0].first_name+" "+ownerInfo.response[0].last_name,videoAuthor?videoAuthor=" / "+videoAuthor:videoAuthor="",videoName='<span id="videoType"><img src="'+imagesPath+'icons/vk.png"></span>'+videoInfo.title+videoAuthor,vData.title=decodeURIComponent(videoInfo.title);try{mediaURL=videoInfo.files[Object.keys(videoInfo.files)[Object.keys(videoInfo.files).length-1]]}catch(e){console.log(e),mediaURL="vk-fail"}}))})}$("document").ready(function(){loadContinuousPlay(),loadingKeyEvents(),$("#videoContainer").append(loadingSpinner),$("#videoContainer").show(),loadChInfo(),setCurrentTime(),setInterval(setCurrentTime,1e3),"on"==localStorage_getItem("fsClock")&&clockToggle()});